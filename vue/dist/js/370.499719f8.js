"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[370],{5370:function(e,t,s){s.r(t),s.d(t,{default:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("div",[e.isHeader?t("div",{staticClass:"header-tips"},[t("el-alert",{attrs:{title:"部门主管审批权限",type:"warning",description:"作为部门主管，您负责审批本部门员工的资产申请。审批通过后将转交给管理员进行最终审批。您的审批对部门资源分配非常重要。","show-icon":"",closable:!1}}),t("div",{staticClass:"approval-flow"},[t("el-steps",{attrs:{active:2,"finish-status":"success",simple:""}},[t("el-step",{attrs:{title:"员工提交申请"}}),t("el-step",{attrs:{title:"部门主管审批"}}),t("el-step",{attrs:{title:"管理员最终审批"}}),t("el-step",{attrs:{title:"审批完成"}})],1)],1)],1):"ADMIN"===e.user.role?t("div",{staticClass:"header-tips"},[t("el-alert",{attrs:{title:"管理员审批权限",type:"warning",description:"作为系统管理员，您负责最终审批已经通过部门主管审核的资产申请。您的决定将直接影响部门资源分配。","show-icon":"",closable:!1}}),t("div",{staticClass:"approval-flow"},[t("el-steps",{attrs:{active:3,"finish-status":"success",simple:""}},[t("el-step",{attrs:{title:"员工提交申请"}}),t("el-step",{attrs:{title:"部门主管审批"}}),t("el-step",{attrs:{title:"管理员最终审批"}}),t("el-step",{attrs:{title:"审批完成"}})],1)],1)],1):e._e(),t("div",{staticClass:"search"},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入资产名称"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"info",plain:""},on:{click:function(t){return e.load(1)}}},[e._v("查询")]),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning",plain:""},on:{click:e.reset}},[e._v("重置")])],1),t("div",{staticClass:"table"},[t("el-table",{attrs:{data:e.tableData,stripe:""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t("el-table-column",{attrs:{prop:"id",label:"序号",width:"80",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"employeeName",label:"员工姓名","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"departmentName",label:"所属部门","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"resourceName",label:"资产名称"}}),t("el-table-column",{attrs:{prop:"num",label:"申请数量"}}),t("el-table-column",{attrs:{prop:"time",label:"申请时间"}}),t("el-table-column",{attrs:{prop:"process",label:"当前进度"}}),t("el-table-column",{attrs:{prop:"status",label:"审批状态"}}),t("el-table-column",{attrs:{prop:"note",label:"审批说明"}}),"ADMIN"===e.user.role||"主管"===e.user.level?t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.handleEdit(s.row)}}},[e._v("审批")])]}}],null,!1,711460066)}):e._e()],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[5,10,20],"page-size":e.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1),t("el-dialog",{attrs:{title:"信息",visible:e.fromVisible,width:"40%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.fromVisible=t}}},[t("el-form",{ref:"formRef",staticStyle:{"padding-right":"50px"},attrs:{"label-width":"100px",model:e.form,rules:e.rules}},[t("el-form-item",{attrs:{prop:"name",label:"请审批"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择状态"},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},[t("el-option",{attrs:{label:"审批通过",value:"审批通过"}}),t("el-option",{attrs:{label:"审批不通过",value:"审批不通过"}})],1)],1),t("el-form-item",{attrs:{prop:"note",label:"审批说明"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入审批说明"},model:{value:e.form.note,callback:function(t){e.$set(e.form,"note",t)},expression:"form.note"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.fromVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)],1)},l=[],r=(s(8111),s(1701),{name:"Department",data(){return{tableData:[],pageNum:1,pageSize:10,total:0,name:null,fromVisible:!1,form:{},user:JSON.parse(localStorage.getItem("xm-user")||"{}"),ids:[],status:null,rules:{name:[{required:!0,message:"请选择审批状态",trigger:"blur"}],note:[{required:!0,message:"请输入审批说明",trigger:"blur"}]}}},computed:{isHeader(){return"HEADER"===this.user.level||"HEADER"===this.user.role||this.user.level&&this.user.level.includes("主管")}},created(){this.load(1)},methods:{handleAdd(){this.form={},this.fromVisible=!0},handleEdit(e){this.form=JSON.parse(JSON.stringify(e)),this.fromVisible=!0},save(){this.form.status=this.status,this.$request.put("/resourceapply/update",this.form).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load(1),this.fromVisible=!1,this.status=null):this.$message.error(e.msg)}))},del(e){this.$confirm("您确定删除吗？","确认删除",{type:"warning"}).then((t=>{this.$request.delete("/resourceapply/delete/"+e).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load(1)):this.$message.error(e.msg)}))})).catch((()=>{}))},handleSelectionChange(e){this.ids=e.map((e=>e.id))},delBatch(){this.ids.length?this.$confirm("您确定批量删除这些数据吗？","确认删除",{type:"warning"}).then((e=>{this.$request.delete("/resourceapply/delete/batch",{data:this.ids}).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load(1)):this.$message.error(e.msg)}))})).catch((()=>{})):this.$message.warning("请选择数据")},load(e){e&&(this.pageNum=e);const t={pageNum:this.pageNum,pageSize:this.pageSize,name:this.name||null,departmentId:this.isHeader&&"ADMIN"!==this.user.role?this.user.departmentId:null};this.tableData=[],this.$request.get("/resourceapply/selectPage",{params:t}).then((e=>{"200"===e.code?e.data&&Array.isArray(e.data.list)?(this.tableData=e.data.list,this.total=e.data.total||0):(this.$message.warning("未找到匹配的数据"),this.total=0):(this.$message.error(e.msg||"查询失败"),this.total=0)})).catch((e=>{console.error("Query failed:",e),this.$message.error("查询失败，请稍后重试"),this.total=0}))},reset(){this.name=null,this.tableData=[],this.total=0,this.load(1)},handleCurrentChange(e){this.load(e)}}}),i=r,o=s(1656),n=(0,o.A)(i,a,l,!1,null,"eb940e40",null),c=n.exports}}]);
//# sourceMappingURL=370.499719f8.js.map